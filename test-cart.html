<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Cart</title>
  <script src="./js/utils.js"></script>
</head>
<body>
  <h1>Cart Debug Page</h1>
  <button onclick="testAddProduct()">Add Test Product</button>
  <button onclick="testAddProduct2()">Add Test Product 2</button>
  <button onclick="showCart()">Show Cart Contents</button>
  <button onclick="clearCart()">Clear Cart</button>
  <button onclick="goToCart()">Go to Cart Page</button>
  
  <div id="output"></div>

  <script>
    function testAddProduct() {
      const testProduct = {
        id: 1,
        name: "Test Product",
        price: 299,
        thumbnail: getBaseUrl() + "img/logo.png",
        description: "A test product",
        stock: 5,
        quantity: 1
      };
      
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      const existing = cart.find(item => item.id === testProduct.id);
      if (existing) {
        existing.quantity += 1;
      } else {
        cart.push(testProduct);
      }
      localStorage.setItem('cart', JSON.stringify(cart));
      
      document.getElementById('output').innerHTML = '<p>Test product added!</p>';
      showCart();
    }
    
    // Add a second test product with different structure
    function testAddProduct2() {
      const testProduct = {
        id: 2,
        name: "Test Product 2",
        price: 199,
        thumbnail: getBaseUrl() + "img/logo2.png", 
        description: "Another test product",
        quantity: 2
        // Note: no stock property to test undefined handling
      };
      
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      cart.push(testProduct);
      localStorage.setItem('cart', JSON.stringify(cart));
      
      document.getElementById('output').innerHTML = '<p>Test product 2 added!</p>';
      showCart();
    }
    
    function showCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      document.getElementById('output').innerHTML = 
        '<h2>Current Cart:</h2><pre>' + JSON.stringify(cart, null, 2) + '</pre>';
    }
    
    function clearCart() {
      localStorage.removeItem('cart');
      document.getElementById('output').innerHTML = '<p>Cart cleared!</p>';
    }
    
    function goToCart() {
      window.location.href = 'cart.html';
    }
    
    // Show cart on page load
    showCart();
  </script>
</body>
</html>
